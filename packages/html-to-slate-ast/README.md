# @graphcms/html-to-slate-ast

HTML to Slate AST converter for the Hygraph's RichTextAST format.

‚ö†Ô∏è This converter outputs the custom flavour of Slate AST that is used at Hygraph, and will most likely not produce an output compatible with your own Slate implementation. But feel free to fork it and adapt it to your needs.

## ‚ö° Usage

### 1. Install

This package needs to have the packages `slate` and `slate-hyperscript` installed, and `jsdom` as well if you need to run the converter in nodejs.

```bash
# for node or isomorphic usage, jsdom is required
npm install jsdom

# required peer-dependancies
npm install slate@0.66.1 slate-hyperscript@0.67.0
npm install @graphcms/html-to-slate-ast
```

### 2. Convert your data

‚òùÔ∏è `htmlToSlateAst` returns a [Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises)

```js
import { htmlToSlateAST } from '@graphcms/html-to-slate-ast';

const htmlString = '<div><p>test</p></div>'; // or import from a file or database
const ast = await htmlToSlateAST(htmlString);
```

### 3. Use it in your Content API mutations

The output of this converstion is compatible with our `RichTextAST` GraphQL type and can be used to import content in your Rich Text fields.

Example mutation:

```graphql
mutation newArticle($title: String!, $content: RichTextAST) {
  createArticle(data: { title: $title, content: $content }) {
    id
    title
    content {
      html
      raw
    }
  }
}
```

Output generated by `htmlToSlateAST` will represent the `children` array of the [Slate editor object](https://docs.slatejs.org/api/nodes/editor). However, when creating or updating the value of a Rich text field, you are setting the value of the editor node itself. This means that the output should be transformed into a Rich text compatible object, for example:

```js
const data = await client.request(newArticleQuery, {
  title: 'Example title for an article',
  content: { children: ast },
});
```

Here, in terms of Slate, `$content` is the editor node, so the `$ast` array must be assigned to the `children` key in that object.

You can see the full example using [graphql-request](https://github.com/prisma-labs/graphql-request) to mutate the data into Hygraph [here](https://github.com/hygraph/rich-text/blob/main/packages/html-to-slate-ast/examples/graphql-request-script.js)

See the docs about the [Rich Text field type](https://hygraph.com/docs/schema/field-types#rich-text) and [Content Api mutations](https://hygraph.com/docs/content-api/mutations)

## üìù License

Licensed under the MIT License.

---

Made with üíú by Hygraph üëã [join our community](https://slack.hygraph.com/)!
